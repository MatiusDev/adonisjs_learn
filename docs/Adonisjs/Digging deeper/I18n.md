<img src="https://r2cdn.perplexity.ai/pplx-full-logo-primary-dark%402x.png" style="height:64px;margin-right:32px"/>

# [I18n (Digging deeper) | AdonisJS Documentation](https://docs.adonisjs.com/guides/digging-deeper/i18n)

Aquí tienes el archivo markdown de conocimiento base para IA sobre la página oficial de **I18n (Digging deeper)** en AdonisJS v6. El contenido está referenciado explícitamente a su fuente.

***

# I18n (Digging deeper) | AdonisJS Documentation

> Fuente oficial: [I18n (Digging deeper) | AdonisJS Documentation](https://docs.adonisjs.com/guides/digging-deeper/i18n)

***

## Conceptos clave

- **Localization:** Traducción de textos (más regiones, más idiomas).
- **Internationalization (i18n):** Formateo de valores (fechas, números, monto) según región/idioma.
- Soporte gracias a `@adonisjs/i18n`. Traduce validaciones, vistas Edge, controladores, APIs, etc.

***

## Instalación y setup

```bash
node ace add @adonisjs/i18n
```

- Provider en `adonisrc.ts`.
- Crea `config/i18n.ts` y `middleware/detect_user_locale_middleware.ts`.
- Agrega este middleware global en el kernel.

Configuración base:

```js
import app from '@adonisjs/core/services/app'
import { defineConfig, formatters, loaders } from '@adonisjs/i18n'
export default defineConfig({
  defaultLocale: 'en',
  formatter: formatters.icu(),
  loaders: [
    loaders.fs({ location: app.languageFilesPath() }),
  ],
})
```

- Puedes definir `supportedLocales`, `fallbackLocales`…
- Por defecto usa formato ICU (compatible con Crowdin, Lokalise, etc).

***

## Organización de archivos de traducción

- Usar `resources/lang/<idioma>/<archivos>.json|yaml`
Ej:

```
resources/lang/en/messages.json
resources/lang/fr/messages.json
```

- Región específica: `en-us`, `en-uk`, etc.

***

## Uso en backend y Edge

- Resuelve la instancia al vuelo con `i18nManager.locale('en')` y usa `.t('clave')`.

```js
i18n.t('messages.greeting') // Hello world
```

- En Edge: `{{ t('messages.greeting') }}`

***

## Fallbacks y mensajes ausentes

- Si falta una traducción: retorna mensaje de error por defecto (customizable).
- También puedes decidir globalmente el fallback en config.

***

## Middleware de detección de idioma de usuario

- Autodetección por header `Accept-language` y expone instancia de I18n en controlador y plantilla.
- Puedes personalizar la lógica de detección.
- Usa traducciones en validaciones automáticas de formularios y flash messages.

***

## Validaciones traducidas (VineJS)

- Traducciones en `resources/lang/<locale>/validator.json` bajo `shared`.
- Usa `{field}` para interpolar el nombre, `{rule}` para la regla, etc.

***

## Sintaxis ICU avanzada

- Interpolación: `{ username }`
- Números y dinero: `{amount, number, ::currency/USD}`
- Fechas: `{date, date, medium}`
- Plurales:

```yaml
cart_summary: "You have {itemsCount, plural,
  =0 {no items}
  one {1 item}
  other {# items}
} in your cart"
```

- Select/selectordinal:

```yaml
auto_reply: "{gender, select, male {He} female {She} other {They}} will reply"
```


***

## Formateadores adicionales

- `.formatNumber(value, options)`
- `.formatCurrency(value, { currency })`
- `.formatDate(date, options)`
- `.formatTime(date)`
- `.formatRelativeTime(date, unit|'auto')`
- `.formatPlural(value, options)`
- `.formatList(array, options)`
- `.formatDisplayNames(code, { type })`

***

## Testing y DX VSCode

- Puedes forzar recarga de archivos de traducción:
`await i18nManager.reloadTranslations()`
- Extension i18n Ally para descubrir/usabilidad en `.vscode/settings.json`.

***

## Extensión: Loaders y formatters custom

- Puedes implementar tus propios loaders y formatters para almacenar o dar formato a traducciones de donde quieras.

***

## Listening a eventos de claves faltantes

- Puedes emitir o escuchar el evento `i18n:missing:translation` para trackers o reportes.

***

¿Quieres este resumen como archivo `.md` o para algún otro sistema? Indícalo en tu mensaje.

<div style="text-align: center">⁂</div>

[^1]: https://docs.adonisjs.com/guides/digging-deeper/i18n

